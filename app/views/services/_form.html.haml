
:javascript
  $(document).ready(function() {
    $('#dt_date_start, #dt_time_start,' +
    '#dt_date_end,   #dt_time_end').calendricalDateTimeRange({usa:true});
      var virtual_flag = #{@service.is_virtual}
      var scheduled_flag = #{@service.is_schedulelater}
      is_virtual(virtual_flag);
      is_schedulelater(scheduled_flag);

  });

  jQuery(document).ready(function(){
    $('.spinner').hide();

    $( "input#nonprofit_name.form_input_full" ).autocomplete({
      search: function(event, ui) { 
        $('.spinner').show();
      },
      open: function(event, ui) {
        $('.spinner').hide();
      }
    })
    $('#service_is_virtual').click(function(){
      is_virtual($("#service_is_virtual").is(':checked'))
    });
    
    $('#service_is_schedulelater').click(function(){
      is_schedulelater($("#service_is_schedulelater").is(':checked'))
    });
  
  });

  function is_virtual(flag)
  {
    if (flag){
      $('#service_location_attributes_address').attr('disabled', 'disabled');  
      }
    else{
      $('#service_location_attributes_address').removeAttr('disabled');
    }
  }

  function is_schedulelater(flag)
  {
    if (flag){
      $('#service_is_schedulelater').val("true"); 
      $('#dt_date_start').attr('disabled', 'disabled'); 
      $('#dt_date_end').attr('disabled', 'disabled'); 
      $('#dt_time_start').attr('disabled', 'disabled'); 
      $('#dt_time_end').attr('disabled', 'disabled'); 
    }
    else{
      $('#service_is_schedulelater').val("false");
      $('#dt_date_start').removeAttr('disabled');
      $('#dt_date_end').removeAttr('disabled');
      $('#dt_time_start').removeAttr('disabled');
      $('#dt_time_end').removeAttr('disabled');
    }
  }

%h2.offer_form_h2
  Offer a Service to support your favorite non-profit
  - if user_signed_in?
    %span
      Want to copy information from an offer you made previously?
      %a{:href => "#"} Click here
  - else
%a.bro_req_btn{:href => requests_path} Browse Requests
.offer_form
  = form_for @service, :builder => JoshForm, :html => {:multipart => true} do |f|
    - if @service.errors.any?
      #error_explanation
        %h2
          = pluralize(@service.errors.count, "error")
          prohibited this post from being saved:
        %ul
          - @service.errors.full_messages.each do |msg|
            %li= msg
    .setp_box
      %h3.setp_box_heading
        %span Step 1:
        Describe the service or experience you want to offer
      = f.text_field :title, :hint => "Give short and sweet Title to your Service"
      = f.text_area :description, :class => 'input_area', :hint => "Give detail Description of your Service"
      = f.collection_select :category_ids, Category.by_services.order("name"), :id, :name, {:selected => @service.service_categories.collect(&:category_id)}, { :multiple => true, :class => "input_select", :style => "height:100px;width:530px;", :hint => "Select one or more categories matching your service", :label => "Category *" }
    .setp_box
      %h3.setp_box_heading
        %span Step 2:
        Choose the non-profit that you would like to support
      %p
        = f.label "Nonprofit *", :class => "form_lbl"
        = f.hidden_field :nonprofit_id
        = image_tag '/images/spinner.gif', :class => 'spinner'
        = autocomplete_field_tag :nonprofit_name,'', autocomplete_nonprofit_name_services_path, :class => "form_input_full input_half", "data-id-element" => "#service_nonprofit_id", :value => "#{get_nonprofit_name}"
        %span.setp_box_p_span
        or
        = link_to  "click here to browse", browse_nonprofit_services_path , :class => 'thickbox'
    .setp_box
      %h3.setp_box_heading
        %span Step 3:
        Tell us where this service will be offered
      %p
        = f.label "Online Service", :class => 'form_lbl'
        = f.check_box :is_virtual, { :class => "input_checkbox"}, "true", "false"
        %span.setp_box_p_span (Check if this service will be offered virtually/online)
      %p
        = f.fields_for :location do |loc|
          = loc.text_field :address, :class => "input_half"
    .setp_box
      %h3.setp_box_heading
        %span Step 4:
        Tell us when this service will be offered
      %p
        = f.label "Schedule Later", :class => 'form_lbl'
        = f.check_box :is_schedulelater, { :class => "input_checkbox"}, "true", "false"
        %span.setp_box_p_span
          (Leave it checked if you would like to choose a date/time with the buyer after purchase)
          %a{:href => "#"} How it works?
      %p
        %span.setp_two_col
          = f.text_field :start_date, :id => 'dt_date_start',:value => gik_formatted_date(@service.start_date), :class => "input_small"
        %span.setp_two_col
          = f.text_field :start_time, :id => 'dt_time_start', :value => gik_formatted_time(@service.start_time), :class => "input_small"
      %p
        %span.setp_two_col
          = f.text_field :end_date, :id => 'dt_date_end', :value => gik_formatted_date(@service.end_date), :class => "input_small"
        %span.setp_two_col
          = f.text_field :end_time, :id => 'dt_time_end', :value => gik_formatted_time(@service.end_time), :class => "input_small"
      %p
        %span.setp_two_col
          = f.text_field :booking_capacity,  :class => "input_small", :hint => "0 indicates no limit"
        %span.setp_two_col
          = f.text_field :estimated_duration,  :label => "Estimated Duration", :class => "input_small", :hint => "Duration should be in minutes"
    .setp_box
      %h3.setp_box_heading
        %span Step 5:
        What is the requested donation amount for this service?
      %p
        = f.text_field :amount, :label => "Amount ($)", :class => "input_small", :hint => "Min donation amount $5"
    .setp_box
      %h3.setp_box_heading
        %span Step 6:
        Add Picture illustrating your service
      %p
        = f.fields_for :images do |photo|
          = photo.file_field :image, :class => "input_browse", :type => "file", :label => "Select an Image"
      %p
        = f.fields_for :images do |photo|
          - unless photo.object.new_record?
            = link_to( image_tag(photo.object.image.url(:thumb)), photo.object.image.url(:medium) )
            = photo.check_box :_destroy
            Remove Photo
    .setp_box
      %h3.setp_box_heading
        %span Step 7:
        Choose privacy settings for the listing
      %ul.input_radio_nav
        %li
          = f.radio_button(:is_public, true)
          = f.label(:is_public, "I want this listing posted publicly to everyone on the site") 
        %li
          = f.radio_button(:is_public, false)
          = f.label(:is_public, "Don't post this on the site. I will share it with and only those I share it with will be able to access it")
          = f.hidden_field :request_id
    .input_post_div
      = f.submit "Post It", :class => "btn_form button form_post_btn"
      %p You will be able to share it afterwards
    %ul.offer_form_bottom_nav
      %li All services offered must be fully legal under US law and appropriate to discuss in front of people all ages.  Please keep it appropriate and positive!
      %li Please also check specific policies of the non-profit for whom you are offering your service.
      %li GoodInKind reserves the right to remove any postings at any time.
